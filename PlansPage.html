<!DOCTYPE html>
<html>
    <head>
        <title>Travel Plan Details</title>
        <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    </head>
    <body class="bg-gray-100">
        <div class="container mx-auto p-4">
            <h1 id="plan-title" class="text-2xl font-bold text-center text-gray-700">Travel Plan</h1>
            <button id="deleteTravelPlanBtn" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Delete Travel Plan</button>
            <div class="mt-4">
                <h2 class="text-lg">Destination ID: <span id="destination-id" class="font-semibold"></span></h2>
                <h2 class="text-lg">Travel Plan Name: <span id="travel-plan-name" class="font-semibold"></span></h2>
            </div>
            <div>
                <h3 class="font-bold mt-2">Itinerary:</h3>
                <p id="itinerary" class="p-2 border rounded"></p>
                <h3 class="font-bold mt-2">Local Emergency Contacts:</h3>
                <p id="emergency-contacts" class="p-2 border rounded"></p>
            </div>
            <button id="goBack" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Go Back</button>
        </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const planID = urlParams.get('planID');

            
            const deleteBtn = document.getElementById('deleteTravelPlanBtn');
            deleteBtn.addEventListener('click', function() {
                console.log('Delete button clicked');
                deleteTravelPlan(planID);
            });

            function deleteTravelPlan() {
                const urlParams = new URLSearchParams(window.location.search);
                const PlanID = urlParams.get('planID');
                fetch(`/deleteTravelPlan`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ PlanID })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Travel plan deleted successfully');
                    window.location.href = 'TravelPlanner.html';
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Failed to delete travel plan');
                });
            }

            console.log('Plan ID:', planID);
            if (planID) {
                console.log('Fetching plan...');
                fetch(`/plan/${planID}`)
                    .then(response => response.json())
                    .then(plan => {
                        console.log('Plan fetched:', plan);
                        document.getElementById('plan-title').innerText = `Travel Plan ${planID}`;
                        document.getElementById('destination-id').innerText = plan.DestinationID;
                        document.getElementById('travel-plan-name').innerText = plan.TravelPlanName;
                        document.getElementById('itinerary').innerText = plan.Itinerary;
                        document.getElementById('emergency-contacts').innerText = plan.LocalEmergencyContacts;
                    })
                    .catch(error => console.error('Error fetching plan:', error));
            }

            document.getElementById('goBack').addEventListener('click', function() {
                window.location.href = 'landingPage.html';
            });
        });
    </script>
</body>
</html>
